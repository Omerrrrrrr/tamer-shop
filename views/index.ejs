<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <title>Telefon AksesuarlarÄ±</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body class="bg-slate-50 text-slate-900">

    <%- include('partials/header') %>

    <%
      const homeCategories = Array.isArray(categories) ? categories : [];
      const categoryLabels = {};
      homeCategories.forEach(cat => {
        categoryLabels[cat.id] = cat.label;
      });
      const featuredCats = homeCategories.filter(cat => cat.id !== "all").slice(0, 3);
      const fallbackImage = "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?auto=format&fit=crop&w=900&q=80";
    %>

    <section class="gradient-hero border-b border-slate-200/80">
      <div class="max-w-6xl mx-auto px-4 py-12 grid gap-10 md:grid-cols-[1.1fr,0.9fr] items-center">
        <div class="space-y-5">
          <p class="soft-badge">Yeni sezon aksesuar Â· HÄ±zlÄ± teslimat</p>
          <h1 class="text-4xl md:text-5xl font-semibold leading-tight text-slate-900">
            TarzÄ±nÄ± yansÄ±tan aksesuarlarÄ± seÃ§, kapÄ±na hÄ±zlÄ± gelsin.
          </h1>
          <p class="text-sm text-slate-600 max-w-xl">
            GÃ¼ncel stok, kaliteli gÃ¶rseller ve tek tÄ±kla sipariÅŸ akÄ±ÅŸÄ±. KÄ±lÄ±f, cam, ÅŸarj ve powerbank seÃ§eneklerini kolayca karÅŸÄ±laÅŸtÄ±r ve sepetine ekle.
          </p>
          <div class="flex flex-wrap gap-3">
            <a href="/products" class="btn-primary">ÃœrÃ¼nleri GÃ¶r</a>
            <a href="https://wa.me/+905428904151" target="_blank" class="btn-secondary">SatÄ±ÅŸ Ekibi</a>
          </div>
          <dl class="grid grid-cols-3 gap-4 text-sm text-slate-600">
            <div class="card glass">
              <dt class="text-xs text-slate-500 uppercase">ÃœrÃ¼n</dt>
              <dd class="text-2xl font-semibold text-slate-900"><%= totalProducts %>+</dd>
            </div>
            <div class="card glass">
              <dt class="text-xs text-slate-500 uppercase">Kategori</dt>
              <dd class="text-2xl font-semibold text-slate-900"><%= totalCategories %></dd>
            </div>
            <div class="card glass">
              <dt class="text-xs text-slate-500 uppercase">Stok</dt>
              <dd class="text-2xl font-semibold text-slate-900"><%= totalStock %>+</dd>
            </div>
          </dl>
          <div class="flex flex-wrap gap-2 text-xs text-slate-500">
            <span class="chip">HD Ã¼rÃ¼n gÃ¶rselleri</span>
            <span class="chip">HÄ±zlÄ± sevkiyat</span>
            <span class="chip">Kolay iade</span>
          </div>
        </div>

        <div class="card glass relative overflow-hidden">
          <div class="absolute -top-16 -right-10 w-52 h-52 rounded-full bg-indigo-200 blur-3xl opacity-70"></div>
          <div class="absolute -bottom-12 -left-6 w-48 h-48 rounded-full bg-cyan-200 blur-3xl opacity-70"></div>
          <div class="relative z-10 space-y-4">
            <div class="flex items-center justify-between">
              <p class="section-label text-indigo-500">Ã–ne Ã§Ä±kan kategoriler</p>
              <span class="text-xs text-slate-500">16:00 Ã¶ncesi aynÄ± gÃ¼n hazÄ±rlÄ±k</span>
            </div>
            <div class="grid gap-3">
              <% featuredCats.forEach(cat => { %>
                <a
                  href="<%= '/products?cat=' + cat.id %>"
                  class="flex items-center justify-between rounded-xl border border-white/60 bg-white/70 px-4 py-3 shadow-sm hover:-translate-y-0.5 hover:border-indigo-100 transition">
                  <div class="flex items-center gap-3">
                    <div class="w-10 h-10 img-frame">
                      <% if (cat.image_url) { %>
                        <img src="<%= cat.image_url %>" alt="<%= cat.label %>" class="w-full h-full object-cover" />
                      <% } else { %>
                        <div class="w-full h-full flex items-center justify-center text-lg text-slate-400">ðŸ“¦</div>
                      <% } %>
                    </div>
                    <div>
                      <p class="font-semibold text-slate-900"><%= cat.label %></p>
                      <p class="text-xs text-slate-500">MaÄŸazada Ã¶ne Ã§Ä±kar</p>
                    </div>
                  </div>
                  <span class="text-sm text-indigo-600">â†—</span>
                </a>
              <% }) %>
            </div>
            <div class="mt-4 overflow-hidden rounded-xl border border-white/70 shadow-md">
              <img
                src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?auto=format&fit=crop&w=900&q=80"
                alt="ÃœrÃ¼n gÃ¶rsel"
                class="w-full h-48 object-cover" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="max-w-6xl mx-auto px-4 py-10 space-y-6">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div>
          <p class="section-label text-indigo-500">Kategoriler</p>
          <h2 class="text-2xl font-semibold mt-1">Ä°htiyacÄ±nÄ± saniyeler iÃ§inde bul</h2>
        </div>
        <a href="/products" class="text-sm text-indigo-600 hover:underline">TÃ¼m Ã¼rÃ¼nleri gÃ¶r</a>
      </div>
      <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
        <% homeCategories.forEach(cat => { %>
          <a
            href="<%= cat.id === 'all' ? '/products' : '/products?cat=' + cat.id %>"
            class="card glass flex items-center gap-4 hover:-translate-y-1 transition">
            <div class="w-14 h-14 img-frame">
              <% if (cat.image_url) { %>
                <img src="<%= cat.image_url %>" alt="<%= cat.label %>" class="w-full h-full object-cover" />
              <% } else { %>
                <div class="w-full h-full flex items-center justify-center text-2xl text-slate-400">ðŸ“¦</div>
              <% } %>
            </div>
            <div>
              <p class="font-semibold text-slate-900"><%= cat.label %></p>
              <p class="text-xs text-slate-500">
                <%= cat.id === 'all' ? 'TÃ¼m katalog' : 'Kategori vitrinine gÃ¶z at' %>
              </p>
            </div>
          </a>
        <% }) %>
      </div>
    </section>

    <main class="max-w-6xl mx-auto py-10 px-4">
      <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
        <div>
          <p class="text-xs uppercase tracking-[0.3em] text-indigo-500 font-semibold">SeÃ§ilenler</p>
          <h2 class="text-2xl font-semibold">Ã–ne Ã§Ä±kan Ã¼rÃ¼nler</h2>
        </div>
        <a href="/products" class="text-sm text-gray-600 hover:text-indigo-600 font-medium">
          TÃ¼mÃ¼nÃ¼ incele â†’
        </a>
      </div>

      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
        <% products.forEach(product => { %>
          <article class="card flex flex-col hover:-translate-y-1 transition">
            <div class="img-frame group h-36 text-4xl flex items-center justify-center">
              <% if ((product.discount_percent || 0) > 0) { %>
                <span class="absolute top-2 left-2 max-w-[80%] truncate text-[11px] font-semibold text-white bg-rose-600 px-2.5 py-1 rounded-full shadow-xl ring-2 ring-white/70 backdrop-blur-sm" style="text-shadow:0 1px 2px rgba(0,0,0,0.35);">
                  FÄ±rsat -<%= product.discount_percent %>%
                </span>
              <% } %>
              <% if (product.image_url) { %>
                <img
                  src="<%= product.image_url %>"
                  alt="<%= product.name %>"
                  class="w-full h-full object-cover" />
              <% } else { %>
                <div class="w-full h-full flex items-center justify-center text-4xl text-slate-400">
                  ðŸ“¦
                </div>
              <% } %>
            </div>
            <p class="text-xs text-slate-500 mt-3">
              <%= categoryLabels[product.category] || 'ÃœrÃ¼n' %>
            </p>
            <h3 class="text-lg font-semibold mt-1">
              <a href="/products/<%= product.id %>" class="hover:text-indigo-600">
                <%= product.name %>
              </a>
            </h3>
            <p class="text-sm text-gray-500 mt-1 flex-1">
              <%= product.description %>
            </p>

            <p class="text-sm font-semibold text-slate-900 mt-2 mb-3 flex items-center gap-2">
              <% if ((product.discount_percent || 0) > 0) { %>
                <span class="text-[11px] text-white font-semibold bg-rose-600 px-2.5 py-1 rounded-full shadow-lg ring-1 ring-white/60 backdrop-blur-sm max-w-[70%] truncate" style="text-shadow:0 1px 2px rgba(0,0,0,0.35);">
                  FÄ±rsat -<%= product.discount_percent %>%
                </span>
                <span class="line-through text-slate-400 text-xs">
                  â‚º<%= Number(product.price || 0).toFixed(2) %>
                </span>
                <span class="px-2 py-1 rounded-lg bg-slate-900 text-white shadow">
                  â‚º<%= Number(product.salePrice || product.price || 0).toFixed(2) %>
                </span>
              <% } else { %>
                â‚º<%= Number(product.price || 0).toFixed(2) %>
              <% } %>
            </p>

            <div class="flex gap-2 mt-auto">
              <% if (Number(product.stock || 0) > 0 && Number(product.price || 0) > 0) { %>
                <a
                  href="/cart/add/<%= product.id %>"
                  class="flex-1 text-center bg-indigo-600 text-white text-sm font-medium py-2 rounded-xl hover:bg-indigo-700 transition">
                  Sepete Ekle
                </a>
              <% } else { %>
                <button
                  class="flex-1 text-center bg-slate-200 text-slate-500 text-sm font-medium py-2 rounded-xl cursor-not-allowed"
                  disabled>
                  Stokta Yok
                </button>
              <% } %>
              <a
                href="<%= product.category === 'all' ? '/products' : '/products?cat=' + product.category %>"
                class="px-4 py-2 rounded-xl border border-gray-200 text-sm text-gray-700 hover:border-indigo-200">
                Kategori
              </a>
            </div>
          </article>
        <% }) %>
      </div>
    </main>

    <%- include('partials/footer') %>
  </body>
</html>
