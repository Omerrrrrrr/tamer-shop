<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <title>Ürün Düzenle | Admin</title>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body class="bg-slate-50 text-slate-900">
    <%- include('../partials/header') %>

    <main class="max-w-3xl mx-auto px-4 py-10">
      <div class="mb-6">
        <p class="soft-badge">Admin</p>
        <h1 class="text-2xl font-semibold mt-2">Ürün Düzenle</h1>
        <p class="text-sm text-slate-500 mt-1">
          Ürün bilgilerini ve görsellerini güncelleyebilirsin.
        </p>
      </div>

      <div class="card glass p-6">
        <% if (error) { %>
          <p class="text-sm text-rose-600 mb-4"><%= error %></p>
        <% } %>

        <form method="POST" action="/admin/products/edit/<%= product.id %>" class="space-y-4" enctype="multipart/form-data">
          <div>
            <label class="block text-xs text-slate-600 mb-1">Ürün Adı</label>
            <input
              type="text"
              name="name"
              value="<%= product.name %>"
              class="input"
              required
            />
          </div>

          <div>
            <label class="block text-xs text-slate-600 mb-1">Açıklama</label>
            <textarea
              name="desc"
              rows="3"
              class="input"><%= product.description || '' %></textarea>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-slate-600 mb-1">Kategori</label>
              <select
                name="category"
                class="input"
              >
                <% categories.forEach(cat => { if (cat.id !== 'all') { %>
                  <option value="<%= cat.id %>" <%= product.category === cat.id ? 'selected' : '' %>>
                    <%= cat.label %>
                  </option>
                <% }}); %>
              </select>
            </div>

            <div>
              <label class="block text-xs text-slate-600 mb-1">Stok</label>
              <input
                type="number"
                name="stock"
                value="<%= product.stock %>"
                class="input"
                min="0"
                required
              />
            </div>
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-xs text-slate-600 mb-1">Fiyat (₺)</label>
              <input
                type="number"
                step="0.01"
                name="price"
                value="<%= product.price %>"
                class="input"
                min="0.01"
                required
              />
            </div>

            <div>
              <label class="block text-xs text-slate-600 mb-1">İndirim (%)</label>
              <input
                type="number"
                step="1"
                name="discount"
                value="<%= product.discount_percent || 0 %>"
                class="input"
                min="0"
                max="90"
              />
              <p class="text-[11px] text-slate-400 mt-1">İndirimli fiyat otomatik hesaplanır.</p>
            </div>
          </div>

          <div>
            <label class="block text-xs text-slate-600 mb-1">
              Görsel URL'leri (her satıra bir)
            </label>
            <textarea
              name="imageUrls"
              rows="4"
              class="input"
              placeholder="Her satıra bir görsel URL yazın"
            ><%= (product.images || []).join('\n') %></textarea>
            <p class="text-[11px] text-slate-400 mt-1">
              İlk satır ana görsel olarak kullanılacaktır.
            </p>
          </div>

          <div>
            <label class="block text-xs text-slate-600 mb-1">Cihazdan görsel yükle</label>
            <input
              type="file"
              name="imageFiles"
              accept="image/*"
              multiple
              class="input"
            />
            <p class="text-[11px] text-slate-400 mt-1">
              Yüklenen dosyalar /uploads klasörüne eklenir, URL'lere eklenir.
            </p>
          </div>

          <div class="flex justify-between items-center pt-2">
            <a href="/admin/products" class="text-xs text-slate-500 hover:underline">
              ← Listeye dön
            </a>
            <button
              type="submit"
              class="btn-primary"
            >
              Kaydet
            </button>
          </div>
        </form>
      </div>
    </main>
    <%- include('../partials/footer') %>
  </body>
</html>
